<html>
  <head>
    <title>Message GUI</title>
    <script type="text/javascript" src="/javascripts/jquery.js"></script>
    <!--script type="text/javascript" src="/ckeditor/ckeditor.js"></script>
    <script type="text/javascript" src="/ckeditor/adapters/jquery.js"></script-->
    <script type="text/javascript" src="/tinymce/jscripts/tiny_mce/tiny_mce.js"></script>
    <script type="text/javascript">
      tinyMCE.init({
        theme : "advanced",
        mode : "specific_textareas",
        editor_selector : "editor",
        plugins : "fullpage",
        theme_advanced_buttons3_add : "fullpage"
      });
    </script>
    <script type="text/javascript">
      $(document).ready(function() {
        /*$("#editor").ckeditor();*/
        $("#gem").click(function() {
          var ed = tinyMCE.get('editor');
          var msg = ed.getContent(); /* $("#editor").val();         */
          var wf = $("#workflow").val();
          var name = $("#name").val();
          var data = {"msg" : msg, "workflow" : wf, "name" : name};
          $.ajax({
                  type: "POST",
                  accepts: "application/json",        
                  cache: false,
                  contentType: "text/plain", 
                  url: "/message/template",
                  dataType: "json",
                  data: JSON.stringify(data),
                  error: function(request,error){
                    alert(error);
                  },
                  success: function(result) {
 	            alert("Data saved");
                  }
                 });
        });
      });
    </script>
  </head>
  <body>
    <form method="post">
      <p>
	Skriv template:<br />
	<textarea id="editor" class="editor" cols="80" rows="25">Initial value.</textarea>
      </p>
      <p>
        Beskriv workflow:<br />
        <textarea id="workflow" name="workflow" cols="60" rows="15">(condp = (sendmail)
        :bounce (condp = (sendsms)
                  :bounce (sendspoc))
        :ok :ok)</textarea>
      </p>
      <p>
        Navngiv message flow:<br />
        <input type="text" id="name" />
      </p>
      <p>
	<input type="button" value="Gem" id="gem" />
      </p>
    </form>
  </body>
</html>


